<!DOCTYPE html>
<html lang='en'>
    <head>
        <meta charset='UTF-8'>
        <meta name='description' content='test'>
        <meta name='keywords' content='HTMl, CSS, JS,'>
        <meta name='author' content='Leon Lit'>
        <meta name='viewport' content='width=device-width, initial-scale=1.0'>
        <link rel="apple-touch-icon" sizes="180x180" href="/icon/logo_180.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/icon/logo_32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/icon/logo_16.png">
        <script src="https://cdn.socket.io/3.1.3/socket.io.min.js" integrity="sha384-cPwlPLvBTa3sKAgddT6krw0cJat7egBga3DJepJyrLl4Q9/5WLra3rrnMcyTyOnh" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@3.4.1/dist/chart.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>    
        <title>Wifi Monitor</title>
        <link rel='stylesheet' href='/css/index.css'>
    </head>
    <body>
        <h1 id="title">WIFI Speed Monitor</h1>
        <div id="chartCont">
            <canvas id="wifi_data_chart"></canvas>
        </div>
        <div id="filterCont">
            <div class="filterItem">
                <label for="filterDate">Filter Date: </label>
                <input type="date" id="startDate" class="filterInput"/>
                <label> To: </label>
                <input type="date" id="endDate" class="filterInput"/>
            </div>
            <div class="filterItem">
                <label for="filterTime">Filter Time: </label>
                <input type="time" id="startTime" class="filterInput"/>
                <label> To: </label>
                <input type="time" id="endTime" class="filterInput"/>
            </div>
            <button id="filterBtn">Filter</button>
        </div>
    </body>
</html>

<script src="/js/chartManagement.js"></script>
<script>
    let socket;
    let initial = true;
    $(document).ready(function() {
        namespace = '/wifi_data';
        socket = io(namespace);

        socket.on("connect_error", (err) => {
            console.log(`connect_error due to ${err.message}`);
        });

        socket.on('connect', function() {
            console.log("connected");
            socket.emit('new_wifi_data')
        });

        socket.on("new_data", function(data){
            console.log(data);
            if (initial) {
                draw_chart(data);
                initial = false;
            }else {
                add_data(data)
            }
            socket.emit('new_wifi_data');
        })
    })

    
</script>